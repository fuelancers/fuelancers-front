import{z as Ue,j as _,a as h,A as b,r as Le,u as W,B as oe,o as Ie,Q as ne,P as Y,l as De,J as G,S as Te}from"./index-2d13988b.js";import{B as le}from"./button.component-2c24a3df.js";import{u as C}from"./useDispatch-2f67bffc.js";import{u as Ee}from"./useFetch-6871c5fb.js";var L=(e=>(e.open="OPEN",e.close="CLOSE",e))(L||{});function xe({show:e,onClose:a,title:r,labelButton:i,handleAction:u,children:t}){return e?Ue.createPortal(_("div",{className:"modal fixed inset-0 h-full z-20 grid place-items-center",children:[_("section",{className:"p-4 md:p-6 content-modal bg-white w-11/12 max-w-xl absolute z-30 h-auto top-10 left-2/4 -translate-x-2/4 rounded-lg shadow-box",children:[h("button",{className:"close-button w-6 h-6 flex justify-center items-center rounded-full shadow-square p-1 absolute -top-2.5 -right-2.5 bg-white-bg",onClick:a,children:h("img",{src:"/assets/icons/close-icon.svg",width:10,height:10,alt:"√çcono de cierre"})}),_("div",{className:"content max-h-85vh overflow-y-auto overflow-x-hidden ",children:[_("div",{className:"top relative",children:[h("h4",{className:"title-modal font-bold text-sm text-primary uppercase",children:r}),h("hr",{className:"mt-3 mb-6  border-text-50"})]}),h("div",{className:"body",children:t}),_("div",{className:"bottom mt-12",children:[h(le,{data:{label:i,onClick:u}}),h(le,{data:{label:"Descartar",customStyles:"btn-discard mx-auto mt-4 mb-0 text-sm",onClick:a}})]})]})]}),h("div",{className:"overlay w-full absolute z-20 insert-0 h-full bg-text-90 opacity-25",id:"overlay",onClick:a})]}),document.querySelector("#modals")):null}var se={},Q={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.getListFiles=e.getImage=e.getBase64=e.getAcceptTypeString=e.openFileDialog=void 0,e.openFileDialog=function(a){a.current&&a.current.click()},e.getAcceptTypeString=function(a,r){return a!=null&&a.length?a.map(function(i){return"."+i}).join(", "):r?"":"image/*"},e.getBase64=function(a){var r=new FileReader;return new Promise(function(i){r.addEventListener("load",function(){return i(String(r.result))}),r.readAsDataURL(a)})},e.getImage=function(a){var r=new Image;return new Promise(function(i){r.addEventListener("load",function(){return i(r)}),r.src=URL.createObjectURL(a)})},e.getListFiles=function(a,r){for(var i=[],u=0;u<a.length;u+=1)i.push(e.getBase64(a[u]));return Promise.all(i).then(function(t){var o=t.map(function(l,c){var n;return n={},n[r]=l,n.file=a[c],n});return o})}})(Q);var ue={},T={};Object.defineProperty(T,"__esModule",{value:!0});T.DEFAULT_DATA_URL_KEY=T.INIT_MAX_NUMBER=T.DEFAULT_NULL_INDEX=void 0;T.DEFAULT_NULL_INDEX=-1;T.INIT_MAX_NUMBER=1e3;T.DEFAULT_DATA_URL_KEY="dataURL";(function(e){var a=b&&b.__awaiter||function(t,o,l,c){function n(s){return s instanceof l?s:new l(function(m){m(s)})}return new(l||(l=Promise))(function(s,m){function y(v){try{d(c.next(v))}catch(g){m(g)}}function I(v){try{d(c.throw(v))}catch(g){m(g)}}function d(v){v.done?s(v.value):n(v.value).then(y,I)}d((c=c.apply(t,o||[])).next())})},r=b&&b.__generator||function(t,o){var l={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},c,n,s,m;return m={next:y(0),throw:y(1),return:y(2)},typeof Symbol=="function"&&(m[Symbol.iterator]=function(){return this}),m;function y(d){return function(v){return I([d,v])}}function I(d){if(c)throw new TypeError("Generator is already executing.");for(;l;)try{if(c=1,n&&(s=d[0]&2?n.return:d[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,d[1])).done)return s;switch(n=0,s&&(d=[d[0]&2,s.value]),d[0]){case 0:case 1:s=d;break;case 4:return l.label++,{value:d[1],done:!1};case 5:l.label++,n=d[1],d=[0];continue;case 7:d=l.ops.pop(),l.trys.pop();continue;default:if(s=l.trys,!(s=s.length>0&&s[s.length-1])&&(d[0]===6||d[0]===2)){l=0;continue}if(d[0]===3&&(!s||d[1]>s[0]&&d[1]<s[3])){l.label=d[1];break}if(d[0]===6&&l.label<s[1]){l.label=s[1],s=d;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(d);break}s[2]&&l.ops.pop(),l.trys.pop();continue}d=o.call(t,l)}catch(v){d=[6,v],n=0}finally{c=s=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0}),e.getErrorValidation=e.isMaxNumberValid=e.isAcceptTypeValid=e.isMaxFileSizeValid=e.isImageValid=e.isResolutionValid=void 0;var i=T,u=Q;e.isResolutionValid=function(t,o,l,c){if(l===void 0&&(l=0),c===void 0&&(c=1),!l||!c||!t.width||!t.height)return!0;switch(o){case"absolute":{if(t.width===l&&t.height===c)return!0;break}case"ratio":{var n=l/c;if(t.width/t.height===n)return!0;break}case"less":{if(t.width<=l&&t.height<=c)return!0;break}case"more":{if(t.width>=l&&t.height>=c)return!0;break}}return!1},e.isImageValid=function(t){return!!t.includes("image")},e.isMaxFileSizeValid=function(t,o){return o?t<=o:!0},e.isAcceptTypeValid=function(t,o){if(t&&t.length>0){var l=o.split(".").pop()||"";if(t.findIndex(function(c){return c.toLowerCase()===l.toLowerCase()})<0)return!1}return!0},e.isMaxNumberValid=function(t,o,l){if(o!==0&&!o)return!0;if(l===i.DEFAULT_NULL_INDEX){if(t<=o)return!0}else if(t<=o+1)return!0;return!1},e.getErrorValidation=function(t){var o=t.fileList,l=t.value,c=t.maxNumber,n=t.keyUpdate,s=t.acceptType,m=t.maxFileSize,y=t.resolutionType,I=t.resolutionWidth,d=t.resolutionHeight,v=t.allowNonImageType;return a(void 0,void 0,void 0,function(){var g,D,w,k,A;return r(this,function(N){switch(N.label){case 0:return g={},e.isMaxNumberValid(o.length+l.length,c,n)?[3,1]:(g.maxNumber=!0,[3,5]);case 1:D=0,N.label=2;case 2:return D<o.length?(w=o[D].file,w?!v&&!e.isImageValid(w.type)?(g.acceptType=!0,[3,5]):e.isAcceptTypeValid(s,w.name)?e.isMaxFileSizeValid(w.size,m)?y?[4,u.getImage(w)]:[3,4]:(g.maxFileSize=!0,[3,5]):(g.acceptType=!0,[3,5]):[3,4]):[3,5];case 3:if(k=N.sent(),A=e.isResolutionValid(k,y,I,d),!A)return g.resolution=!0,[3,5];N.label=4;case 4:return D+=1,[3,2];case 5:return Object.values(g).find(Boolean)?[2,g]:[2,null]}})})}})(ue);var $=b&&b.__assign||function(){return $=Object.assign||function(e){for(var a,r=1,i=arguments.length;r<i;r++){a=arguments[r];for(var u in a)Object.prototype.hasOwnProperty.call(a,u)&&(e[u]=a[u])}return e},$.apply(this,arguments)},Ae=b&&b.__createBinding||(Object.create?function(e,a,r,i){i===void 0&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return a[r]}})}:function(e,a,r,i){i===void 0&&(i=r),e[i]=a[r]}),Se=b&&b.__setModuleDefault||(Object.create?function(e,a){Object.defineProperty(e,"default",{enumerable:!0,value:a})}:function(e,a){e.default=a}),Fe=b&&b.__importStar||function(e){if(e&&e.__esModule)return e;var a={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&Ae(a,e,r);return Se(a,e),a},z=b&&b.__awaiter||function(e,a,r,i){function u(t){return t instanceof r?t:new r(function(o){o(t)})}return new(r||(r=Promise))(function(t,o){function l(s){try{n(i.next(s))}catch(m){o(m)}}function c(s){try{n(i.throw(s))}catch(m){o(m)}}function n(s){s.done?t(s.value):u(s.value).then(l,c)}n((i=i.apply(e,a||[])).next())})},X=b&&b.__generator||function(e,a){var r={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},i,u,t,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(n){return function(s){return c([n,s])}}function c(n){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,u&&(t=n[0]&2?u.return:n[0]?u.throw||((t=u.return)&&t.call(u),0):u.next)&&!(t=t.call(u,n[1])).done)return t;switch(u=0,t&&(n=[n[0]&2,t.value]),n[0]){case 0:case 1:t=n;break;case 4:return r.label++,{value:n[1],done:!1};case 5:r.label++,u=n[1],n=[0];continue;case 7:n=r.ops.pop(),r.trys.pop();continue;default:if(t=r.trys,!(t=t.length>0&&t[t.length-1])&&(n[0]===6||n[0]===2)){r=0;continue}if(n[0]===3&&(!t||n[1]>t[0]&&n[1]<t[3])){r.label=n[1];break}if(n[0]===6&&r.label<t[1]){r.label=t[1],t=n;break}if(t&&r.label<t[2]){r.label=t[2],r.ops.push(n);break}t[2]&&r.ops.pop(),r.trys.pop();continue}n=a.call(e,r)}catch(s){n=[6,s],u=0}finally{i=t=0}if(n[0]&5)throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}},K=b&&b.__spreadArrays||function(){for(var e=0,a=0,r=arguments.length;a<r;a++)e+=arguments[a].length;for(var i=Array(e),u=0,a=0;a<r;a++)for(var t=arguments[a],o=0,l=t.length;o<l;o++,u++)i[u]=t[o];return i};Object.defineProperty(se,"__esModule",{value:!0});var U=Fe(Le),q=Q,ke=ue,E=T,Me=function(e){var a=e.value,r=a===void 0?[]:a,i=e.onChange,u=e.onError,t=e.children,o=e.dataURLKey,l=o===void 0?E.DEFAULT_DATA_URL_KEY:o,c=e.multiple,n=c===void 0?!1:c,s=e.maxNumber,m=s===void 0?E.INIT_MAX_NUMBER:s,y=e.acceptType,I=e.maxFileSize,d=e.resolutionWidth,v=e.resolutionHeight,g=e.resolutionType,D=e.inputProps,w=D===void 0?{}:D,k=e.allowNonImageType,A=k===void 0?!1:k,N=r||[],M=U.useRef(null),H=U.useState(E.DEFAULT_NULL_INDEX),S=H[0],j=H[1],J=U.useState(null),Z=J[0],ee=J[1],te=U.useState(!1),ce=te[0],V=te[1],O=U.useCallback(function(){return q.openFileDialog(M)},[M]),de=U.useCallback(function(){j(E.DEFAULT_NULL_INDEX),O()},[O]),fe=U.useCallback(function(){i==null||i([])},[i]),he=function(f){var p=K(N);Array.isArray(f)?f.forEach(function(x){p.splice(x,1)}):p.splice(f,1),i==null||i(p)},me=function(f){j(f),O()},ge=function(f){return z(void 0,void 0,void 0,function(){var p;return X(this,function(x){switch(x.label){case 0:return[4,ke.getErrorValidation({fileList:f,maxFileSize:I,maxNumber:m,acceptType:y,keyUpdate:S,resolutionType:g,resolutionWidth:d,resolutionHeight:v,value:N,allowNonImageType:A})];case 1:return p=x.sent(),p?(ee(p),u==null||u(p,f),[2,!1]):(Z&&ee(null),[2,!0])}})})},ae=function(f){return z(void 0,void 0,void 0,function(){var p,x,F,P,re,R;return X(this,function(B){switch(B.label){case 0:return f?[4,q.getListFiles(f,l)]:[2];case 1:return p=B.sent(),p.length?[4,ge(p)]:[2];case 2:if(x=B.sent(),!x)return[2];if(P=[],S>E.DEFAULT_NULL_INDEX)re=p[0],F=K(N),F[S]=re,P.push(S);else if(n)for(F=K(N,p),R=N.length;R<F.length;R+=1)P.push(R);else F=[p[0]],P.push(0);return i==null||i(F,P),[2]}})})},ve=function(f){return z(void 0,void 0,void 0,function(){return X(this,function(p){switch(p.label){case 0:return[4,ae(f.target.files)];case 1:return p.sent(),S>E.DEFAULT_NULL_INDEX&&j(E.DEFAULT_NULL_INDEX),M.current&&(M.current.value=""),[2]}})})},pe=U.useMemo(function(){return q.getAcceptTypeString(y,A)},[y,A]),be=function(f){f.preventDefault(),f.stopPropagation()},_e=function(f){f.preventDefault(),f.stopPropagation(),f.dataTransfer.items&&f.dataTransfer.items.length>0&&V(!0)},ye=function(f){f.preventDefault(),f.stopPropagation(),V(!1)},we=function(f){f.preventDefault(),f.stopPropagation(),V(!1),f.dataTransfer.files&&f.dataTransfer.files.length>0&&ae(f.dataTransfer.files)},Ne=function(f){f.preventDefault(),f.stopPropagation(),f.dataTransfer.clearData()};return U.default.createElement(U.default.Fragment,null,U.default.createElement("input",$({type:"file",accept:pe,ref:M,multiple:n&&S===E.DEFAULT_NULL_INDEX,onChange:ve,style:{display:"none"}},w)),t==null?void 0:t({imageList:N,onImageUpload:de,onImageRemoveAll:fe,onImageUpdate:me,onImageRemove:he,errors:Z,dragProps:{onDrop:we,onDragEnter:_e,onDragLeave:ye,onDragOver:be,onDragStart:Ne},isDragging:ce}))},Pe=se.default=Me;function Re({isMultiple:e=!0}){const a=C(),r=W(t=>t.general),i=5,u=t=>{const o=t.map(l=>{var c,n;return{data_url:l.data_url,file:{type:(c=l.file)==null?void 0:c.type,name:(n=l.file)==null?void 0:n.name}}});a(oe({imageUpload:o}))};return h("div",{children:h(Pe,{multiple:e,value:r.imageUpload,onChange:u,maxNumber:i,dataURLKey:"data_url",children:({imageList:t,onImageUpload:o,onImageRemove:l,isDragging:c,dragProps:n})=>_("div",{className:"upload__image-wrapper",children:[_("div",{className:"image-uploader",style:c?{background:"#dedede"}:{},...n,children:[h("button",{onClick:o,className:"btn btn-extra",type:"button",children:"Subir foto"}),_("button",{type:"button",className:"drag-here text-center block text-sm",children:["O ",h("br",{}),"arrastra y suelta aqu√≠"]})]}),h("div",{className:"content-images-list d-flex gap-2 wrap",children:t.map((s,m)=>_("div",{className:"image-item shadow-square",children:[h("img",{src:s.data_url,alt:"Imagen",width:100,height:100}),h("button",{onClick:()=>l(m),className:"remove-image shadow-square",children:h("img",{src:"/assets/icons/close-white-icon.svg",width:13,height:13,alt:"Icono de cerrar"})})]},m))})]})})})}function ie({showModal:e,onClose:a,label:r,labelButton:i="A√±adir",handleAction:u}){return h(xe,{show:e,onClose:a,title:r,labelButton:i,handleAction:u,children:h(Re,{isMultiple:!1})})}function Ce(){const e=C(),[a,r]=Ie(),i=(o,l)=>{e(ne({[o]:l===L.open})),t(l)},u=(o,l,c,n)=>{e(ne({[o]:{show:c===L.open,label:l,labelButton:n}})),t(c)},t=o=>{o===L.close&&r()};return{handleToggleModal:i,handleToggleModalWithLabel:u}}const je=(e,a,r)=>({call:Y.post(`${e}`,a)}),Ge=(e,a,r)=>({call:Y.patch(`${e}`,a)});async function Ve(e){return await(await fetch(e)).blob()}const Oe=(e,a)=>({call:Y.get(`${e}`)});function Be(){const e=W(i=>i.user),a=C();return{updateUserService:async()=>{var u;const i=await De(Oe(G.me,e.token));a(Te((u=i.result)==null?void 0:u.data))}}}function $e({data:e,children:a}){const{name:r,title:i,isOwner:u}=e,{handleToggleModalWithLabel:t}=Ce(),{statusModals:o,general:l,user:c,expert:n}=W(g=>g),s=C(),{callEndpoint:m}=Ee(),{updateUserService:y}=Be(),I=()=>{t("modal_profile_header","Agregar Imagen",L.open,"Guardar")},d=()=>{t("modal_profile_bg_header","Agregar Imagen",L.open,"Guardar")},v=async()=>{if(!l.imageUpload.length)return;let g=G.upload_image;o.modal_profile_bg_header.show&&(g=G.upload_bg_image);const D=await Ve(l.imageUpload[0].data_url),w=new FormData;w.append("image",D),await m(je(`${g}`,w,c.token)),await y(),s(oe({imageUpload:[]})),t("modal_profile_header","",L.close,""),t("modal_profile_bg_header","",L.close,"")};return _("div",{className:"header-profile relative xl:pt-6",children:[_("div",{className:"content-sections relative",children:[_("div",{className:"bg w-full h-48 md:h-56 lg:h-64 bg-text-70 xl:rounded-xl  overflow-hidden",children:[h("div",{className:"h-full w-full",children:h("img",{src:n.bgPhoto||c.bgPhoto||"https://ibb.co/nkHWfpM",width:1200,height:600,alt:"Foto de portada",className:"object-cover object-center h-full w-full xl:rounded-xl max-h-[400px]"})}),u?h("div",{className:"content-camera-icon absolute w-9 h-9 rounded-full bg-primary top-4 right-4",children:h("button",{onClick:d,className:"p-2",children:h("img",{src:"/assets/icons/camera-icon.svg",width:24,height:24,alt:"√çcono de c√°mara"})})}):!1]}),h("div",{className:"p-1 photo w-36 h-36 rounded-full border-[1px] border-extra shadow-extra mx-auto absolute top-24 md:top-32 lg:top-44 left-4 md:left-8",children:_("div",{className:"image bg-white w-full h-full rounded-full border-text-70 relative",children:[h("div",{className:"w-full h-full rounded-full overflow-hidden",children:h("img",{src:n.picture||c.picture||"https://ibb.co/KW52rjV",width:244,height:244,alt:"Foto",className:"object-contain object-center h-full"})}),u?h("div",{className:"content-camera-icon absolute w-9 h-9 rounded-full bg-primary -bottom-0 -right-0",children:h("button",{onClick:I,className:"p-2",children:h("img",{src:"/assets/icons/camera-icon.svg",width:24,height:24,alt:"√çcono de c√°mara"})})}):!1]})}),_("div",{className:"grid grid-cols-1 md:grid-cols-2 mb-4 md:mb-10",children:[_("div",{className:"info mt-14 px-4 md:px-8 lg:mt-3 lg:ml-44",children:[h("h5",{className:"font-bold text-lg md:text-xl text-text-100 capitalize",children:r}),i?h("span",{className:"text-sm md:text-base text-text-90",children:i}):null]}),a]})]}),h(ie,{showModal:o.modal_profile_header.show,onClose:()=>t("modal_profile_header","Agregar Imagen",L.close,""),label:o.modal_profile_header.label,labelButton:o.modal_profile_header.labelButton,handleAction:v}),h(ie,{showModal:o.modal_profile_bg_header.show,onClose:()=>t("modal_profile_bg_header","Agregar Imagen",L.close,""),label:o.modal_profile_bg_header.label,labelButton:o.modal_profile_bg_header.labelButton,handleAction:v})]})}export{L as A,Re as I,xe as M,$e as P,Ge as U,je as a,Ve as b,Ce as u};
